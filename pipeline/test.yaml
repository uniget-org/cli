include:
- local: pipeline/docker.yaml

lint:
  rules:
  - if: $CI_PIPELINE_SOURCE == "merge_request_event"
  extends:
  - .docker
  - .docker:dind
  script: |
    docker buildx bake lint

test:
  rules:
  - if: $CI_PIPELINE_SOURCE == "merge_request_event"
  extends:
  - .docker
  - .docker:dind
  script: |
    docker buildx bake test

cli_test:
  rules:
  - if: $CI_PIPELINE_SOURCE == "merge_request_event"
  extends:
  - .docker
  - .docker:dind
  script: |
    docker buildx bake cli-test